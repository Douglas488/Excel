# 📊 Excel数据处理工具使用说明

## ✨ 功能简介
这是一个现代化的Excel数据处理工具，采用科技感十足的深色主题界面，帮您自动处理Excel文件中的SKU查找和成本获取，替代原有的VBA代码功能。

## 🚀 主要功能
1. **🔍 SKU查找**: 根据商品标题自动查找对应的SKU
2. **💰 成本获取**: 根据SKU自动获取对应的成本信息
3. **🧹 数据清理**: 自动清理文本中的特殊字符和格式问题
4. **⚡ 批量处理**: 支持大批量数据的快速处理
5. **📊 数据检查**: 智能分析数据一致性，识别不匹配问题
6. **🎯 自动配置**: 一键设置最佳配置参数

## 安装依赖
在运行程序前，请先安装必要的Python库：
```bash
pip install -r requirements.txt
```

## 🎮 使用步骤

### 1. 🚀 启动程序
**推荐方式**: 双击运行 `启动程序.bat` 文件，享受现代化启动体验

**命令行方式**:
```bash
python excel_processor.py
```

### 2. 🎨 界面特色
- **🌙 深色主题**: 护眼的深色界面，减少视觉疲劳
- **📱 现代化设计**: 卡片式布局，清晰分区
- **🎯 智能交互**: 悬停效果、点击动画、状态反馈
- **📊 实时状态**: 动态进度条和状态信息
- **🔄 滚动支持**: 支持鼠标滚轮和滚动条

### 3. 📁 选择Excel文件
- 点击"📁 浏览文件"按钮选择您的Excel文件
- 程序会自动加载工作簿中的所有工作表
- 界面会显示加载状态和成功提示

### 4. ⚙️ 配置数据源
#### 🔍 SKU数据源设置：
- **工作表**: 选择包含SKU数据的工作表
- **标题列**: 选择商品标题所在的列（如B列）
- **SKU列**: 选择SKU数据所在的列（如C列）

#### 💰 成本数据源设置：
- **工作表**: 选择包含成本数据的工作表
- **SKU列**: 选择SKU标识所在的列
- **成本列**: 选择成本数据所在的列

#### 📤 输出配置：
- **输出工作表**: 选择要处理数据的工作表
- **标题列**: 选择包含产品标题的列（用于搜索SKU）
- **SKU列**: 选择要输出SKU结果的列
- **成本列**: 选择要输出成本结果的列
- **处理范围**: 设置起始行和结束行（默认2-5000）

### 5. 🚀 执行处理
1. **🎯 自动配置**: 点击"自动配置"按钮，一键设置最佳配置
2. **🔍 数据检查**: 点击"数据检查"按钮，分析数据一致性
3. **📥 加载数据**: 点击"加载数据"按钮，将数据源加载到内存
4. **⚡ 开始处理**: 点击"开始处理"按钮，开始批量处理数据
5. **💾 保存结果**: 处理完成后，点击"保存结果"按钮保存到原文件

### 6. 数据检查功能
**数据检查**功能会分析：
- **匹配率**: 显示SKU数据源和成本数据源的匹配情况
- **不匹配SKU**: 列出在成本数据源中找不到的SKU
- **未使用成本SKU**: 列出在SKU数据源中找不到的成本SKU
- **匹配示例**: 显示成功匹配的SKU示例

**常见问题**：
- SKU中包含特殊字符、空格、大小写不一致
- 数据源中的SKU格式不统一
- 建议匹配率低于80%时手动检查数据

### 7. 故障排除
如果遇到问题，可以：
1. 点击"数据检查"按钮查看数据匹配情况
2. 点击"调试信息"按钮查看详细配置信息
3. 点击"测试保存"按钮验证文件保存功能
4. 检查数据源配置是否正确

## 🎨 界面说明

### 📱 主要区域
- **📁 文件选择区**: 选择要处理的Excel文件，支持拖拽和浏览
- **⚙️ 数据源配置区**: 配置SKU和成本数据源，采用卡片式布局
- **🚀 操作控制区**: 主要操作按钮，按功能分组排列
- **📊 处理状态区**: 实时显示处理进度和状态信息

### 🎯 按钮功能
#### 主要操作：
- **🎯 自动配置**: 一键设置最佳配置（推荐首次使用）
- **🔍 数据检查**: 智能分析数据一致性，识别不匹配问题
- **📥 加载数据**: 将数据源加载到内存，提高处理速度
- **⚡ 开始处理**: 执行SKU查找和成本获取
- **💾 保存结果**: 将处理结果保存到Excel文件

#### 工具按钮：
- **🔧 调试信息**: 显示详细的调试信息，帮助排查问题
- **🧪 测试保存**: 测试文件保存功能
- **📖 使用说明**: 查看详细的资料准备和操作教程

### 🌟 界面特色
- **🎨 现代化设计**: 深色主题，科技感十足
- **📱 响应式布局**: 自适应窗口大小，支持滚动
- **🎯 智能交互**: 悬停效果、点击动画、状态反馈
- **📊 实时反馈**: 动态进度条、状态信息、成功提示

## 注意事项

1. **数据格式**: 确保Excel文件格式正确，标题和SKU数据完整
2. **列选择**: 正确选择数据源列和输出列，避免选择错误导致处理失败
3. **处理流程**: 
   - 首先根据产品标题在SKU数据源中查找对应的SKU
   - 然后根据找到的SKU在成本数据源中查找对应的成本
4. **行范围**: 根据实际数据量调整起始行和结束行
5. **备份**: 建议在处理前备份原始文件
6. **内存使用**: 大量数据会占用较多内存，建议分批处理
7. **文件保存**: 
   - 如果原Excel文件正在被其他程序使用，程序会自动创建带时间戳的副本文件
   - 副本文件命名格式：`原文件名_处理结果_时间戳.xlsx`
   - 避免在Excel中打开原文件时进行保存操作

## 技术特点

- **高效处理**: 使用字典缓存，避免重复查找
- **数据清理**: 自动处理特殊字符和格式问题
- **用户友好**: 直观的图形界面，操作简单
- **进度显示**: 实时显示处理进度
- **错误处理**: 完善的错误提示和处理机制

## 故障排除

### 常见问题
1. **文件无法打开**: 检查文件是否被其他程序占用
2. **数据加载失败**: 检查工作表名称和列选择是否正确
3. **处理速度慢**: 减少处理行数或检查数据源大小
4. **结果不正确**: 检查数据源配置和列选择

### 联系支持
如遇到问题，请检查：
- Python版本是否兼容（建议3.7+）
- 依赖库是否正确安装
- Excel文件格式是否正确
- 数据源配置是否准确
