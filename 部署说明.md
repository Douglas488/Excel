# Excel数据处理工具 - 前端部署说明

## 🎉 恭喜！你的后端API已经成功部署

**API地址**: `https://excel-processor-api.onrender.com`

## 📁 前端文件说明

我已经为你创建了一个现代化的前端界面 `index.html`，具有以下特性：

### ✨ 功能特性
- 🎨 **现代化UI设计** - 渐变背景、卡片式布局、响应式设计
- 📤 **拖拽上传** - 支持拖拽Excel文件上传
- ⚙️ **智能配置** - 自动检测工作表，动态更新列选项
- 📊 **实时处理** - 显示处理进度和统计结果
- 📱 **移动端适配** - 完美支持手机和平板访问
- 🎯 **用户友好** - 清晰的步骤指引和错误提示

### 🚀 部署方式

#### 方式1: 直接使用（推荐）
1. 双击打开 `index.html` 文件
2. 在浏览器中直接使用

#### 方式2: 部署到静态网站托管
1. **GitHub Pages**:
   ```bash
   # 创建新仓库
   git init
   git add index.html
   git commit -m "Add frontend"
   git remote add origin https://github.com/你的用户名/excel-processor-frontend.git
   git push -u origin main
   
   # 在GitHub仓库设置中启用Pages
   ```

2. **Netlify**:
   - 访问 [netlify.com](https://netlify.com)
   - 拖拽 `index.html` 到部署区域
   - 获得免费域名

3. **Vercel**:
   ```bash
   npm i -g vercel
   vercel --prod
   ```

## 🔧 使用说明

### 操作步骤
1. **上传文件** - 点击或拖拽Excel文件到上传区域
2. **配置数据源** - 选择对应的工作表和列
3. **开始处理** - 点击"开始处理数据"按钮
4. **下载结果** - 处理完成后下载结果文件

### 配置说明
- **SKU数据源**: 包含产品标题和SKU的映射关系
- **成本数据源**: 包含SKU和成本的映射关系  
- **输出设置**: 指定要处理的工作表和输出列

### 支持的文件格式
- ✅ .xlsx (Excel 2007+)
- ✅ .xls (Excel 97-2003)
- 📏 最大文件大小: 50MB

## 🌐 API接口调用示例

### JavaScript调用示例
```javascript
// 上传文件
const formData = new FormData();
formData.append('file', file);
const uploadResponse = await fetch('https://excel-processor-api.onrender.com/api/upload', {
    method: 'POST',
    body: formData
});

// 处理数据
const processResponse = await fetch('https://excel-processor-api.onrender.com/api/process', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
        file: { content: base64FileContent },
        sku_config: { sheet: "Sheet1", title_col: "B", sku_col: "C" },
        cost_config: { sheet: "Sheet2", sku_col: "A", cost_col: "B" },
        output_config: { sheet: "Order details", title_col: "A", sku_col: "B", cost_col: "D" }
    })
});
```

### Python调用示例
```python
import requests
import base64

# 上传文件
with open('data.xlsx', 'rb') as f:
    file_content = base64.b64encode(f.read()).decode('utf-8')

response = requests.post('https://excel-processor-api.onrender.com/api/process', json={
    "file": {"content": file_content},
    "sku_config": {"sheet": "Sheet1", "title_col": "B", "sku_col": "C"},
    "cost_config": {"sheet": "Sheet2", "sku_col": "A", "cost_col": "B"},
    "output_config": {"sheet": "Order details", "title_col": "A", "sku_col": "B", "cost_col": "D"}
})

result = response.json()
print(f"处理完成: {result['processed_rows']}行")
```

## 🛠️ 技术栈

### 前端
- **HTML5** - 语义化结构
- **CSS3** - 现代化样式，渐变背景，响应式设计
- **JavaScript ES6+** - 异步处理，现代API
- **Font Awesome** - 图标库

### 后端
- **Flask** - Python Web框架
- **openpyxl** - Excel文件处理
- **pandas** - 数据处理
- **Render** - 云部署平台

## 📱 移动端支持

前端界面完全响应式，支持：
- 📱 手机端访问
- 📟 平板端访问  
- 💻 桌面端访问

## 🔒 安全特性

- ✅ 文件类型验证
- ✅ 文件大小限制 (50MB)
- ✅ 安全的文件名处理
- ✅ 临时文件自动清理

## 🚨 注意事项

1. **免费版限制**: Render免费版有资源限制，首次访问可能较慢
2. **文件处理**: 大文件处理时间较长，请耐心等待
3. **浏览器兼容**: 建议使用现代浏览器（Chrome、Firefox、Safari、Edge）

## 🆘 故障排除

### 常见问题
1. **上传失败**: 检查文件格式和大小
2. **处理失败**: 检查Excel文件结构和工作表名称
3. **下载失败**: 检查浏览器下载设置

### 联系支持
如遇到问题，请检查：
- 网络连接是否正常
- 文件格式是否正确
- API服务是否正常运行

---

🎉 **恭喜！你现在拥有了一个完整的Excel数据处理Web应用！**
